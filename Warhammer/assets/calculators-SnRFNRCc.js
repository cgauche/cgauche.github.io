import{s as R,q as m}from"./constants--7Vy3u4O.js";function y(n,o){let r=n.replace(/\s/g,"").replace(/Ã—/g,"*");const t=/B([A-Za-z]+)/g,s=[...r.matchAll(t)].sort((e,l)=>l[0].length-e[0].length);for(const e of s){const l=e[0],a=e[1],i=o[a]||0,b=Math.floor(i/10);r=r.replace(new RegExp(l,"g"),String(b))}try{return p(r)}catch(e){return console.error("Error evaluating wounds formula:",n,e),0}}function p(n){if(n=n.replace(/\s/g,""),!/^[0-9+\-*/().]+$/.test(n))throw new Error("Invalid expression");const o=Function(`'use strict'; return (${n})`)();return Math.floor(o)}function w(n,o){if(!n)return null;const r=n.rand[o];return typeof r=="string"?r:null}function f(n,o,r){let t=n+1831565813|0;t=Math.imul(t^t>>>15,t|1),t^=t+Math.imul(t^t>>>7,t|61);const s=((t^t>>>14)>>>0)/4294967296;return o+Math.floor(s*(r-o+1))}function d(n,o=10){if(typeof n.subRand=="number")return n.subRand;const r=parseInt(n.subRand||"");return isNaN(r)?o:r}function E(n,o,r=10){const t=[...n].sort((s,e)=>d(s,r)-d(e,r));return t.find(s=>o<=d(s,r))||t[t.length-1]}function O(n,o,r={}){if(n.length===0)throw new Error("Cannot roll from empty table");const{getRand:t=c=>c.rand??0,subRollMax:s=10,noSubRoll:e=!1}=r,l=f(o,1,100),a=[...n].filter(c=>t(c)>0).sort((c,g)=>t(c)-t(g));if(a.length===0)return{item:n[0],candidates:[n[0]],roll:l,subRoll:null};const i=a.find(c=>l<=t(c)),b=t(i||a[a.length-1]),u=a.filter(c=>t(c)===b);if(u.length===1||e)return{item:u[0],candidates:u,roll:l,subRoll:null};const h=f(o+R,1,s);return{item:E(u,h,s),candidates:u,roll:l,subRoll:h}}function S(n){const o=f(n,1,10),r=f(n+m,1,10);return o+r}function M(n,o){const r={},t={};let s=0;for(const e of n){if(e.type!=="roll")continue;const l=o+s;r[e.label]=S(l),t[e.label]=l,s+=2}return{rolls:r,seeds:t}}function T(n,o){const r={};for(const t of o)n[t.label]!==void 0&&(r[t.abr]=n[t.label]);return r}export{y as a,M as b,T as c,w as g,O as r,f as s};

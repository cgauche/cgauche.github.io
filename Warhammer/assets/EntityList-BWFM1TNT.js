import{h as C,j as e,I as w,n as k,o as I,i as v,p as L,q as S,s as y,a0 as V,at as _,r as p,g as N}from"./index-BE7IJKJC.js";import{t as E}from"./testId-C2BDkHTB.js";const R=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],H=C("search",R);function M({placeholder:a,value:t,onChange:l,testId:n="entity-search"}){return e.jsxs("div",{className:"relative",children:[e.jsx(H,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),e.jsx(w,{placeholder:a,value:t,onChange:c=>l(c.target.value),className:"pl-10","data-testid":n})]})}function $({config:a,value:t,onChange:l,options:n,highlighted:c,highlightedOptions:h,compact:i}){return e.jsxs("div",{className:"flex items-center gap-2",children:[i&&e.jsxs("span",{className:"text-sm text-muted-foreground",children:[a.label,":"]}),e.jsxs(k,{value:t,onValueChange:l,children:[e.jsx(I,{className:v(i&&"h-8 w-auto min-w-[100px]",c&&"border-primary bg-primary/5 ring-1 ring-primary/30"),children:e.jsx(L,{placeholder:`Tous les ${a.label.toLowerCase()}`})}),e.jsxs(S,{children:[e.jsx(y,{value:"__all__",children:"Tous"}),n.map(o=>{const d=h?.has(o.value);return e.jsxs(y,{value:o.value,className:v(d&&"bg-primary/10 text-primary font-medium"),children:[o.label,d&&" ✦"]},o.value)})]})]})]})}function T({name:a,reference:t,selected:l=!1,highlighted:n=!1,onClick:c,className:h,rightContent:i,entity:o,categoryColor:d,categoryLabel:x}){const f=o?._type,m=f?V[f]?.ui:void 0,g=o&&m?.getCategoryValue?m.getCategoryValue(o):void 0,s=_(f,g),r=d||s,u=x||g,b=E("option",a);return e.jsx("div",{"data-testid":b,onClick:c,className:v("bg-card border rounded-md cursor-pointer transition-all","hover:border-primary/50 hover:translate-x-0.5",l&&r&&"border-l-[3px] translate-x-1",!l&&!n&&"border-secondary",n&&!l&&"border-primary/40 bg-primary/5",h),style:l&&r?{borderLeftColor:r.border,borderColor:r.border,backgroundColor:r.bg}:void 0,children:e.jsxs("div",{className:"flex items-start gap-2 p-2.5",children:[e.jsxs("div",{className:"flex items-start gap-2 flex-1 min-w-0",children:[r&&e.jsx("div",{className:"w-2 h-2 rounded-full flex-shrink-0 mt-1.5",style:{backgroundColor:r.badge}}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"font-inter font-semibold text-sm text-foreground truncate",children:a}),t&&e.jsx("div",{className:"text-[0.7rem] text-muted-foreground",children:t})]})]}),i!==void 0?i:u&&r?e.jsx("div",{className:"text-xs px-2 py-0.5 rounded flex-shrink-0 font-medium",style:{color:r.badge,backgroundColor:r.bg},children:u}):l&&e.jsx("span",{className:"text-primary text-xl",children:"✓"})]})})}function q({entities:a,selectedId:t,onSelect:l,searchPlaceholder:n="Rechercher...",getSearchText:c,getReference:h,isHomebrew:i,isModified:o,isHighlighted:d}){const[x,f]=p.useState(""),m=p.useRef(null);p.useEffect(()=>{t&&m.current?.scrollIntoView&&m.current.scrollIntoView({behavior:"smooth",block:"nearest"})},[t]);const g=p.useMemo(()=>{if(!x)return a;const s=x.toLowerCase();return a.filter(r=>(c?c(r):r.label).toLowerCase().includes(s))},[a,x,c]);return e.jsxs("div",{className:"flex flex-col h-full gap-3",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(M,{placeholder:n,value:x,onChange:f})}),e.jsxs("div",{className:"flex-1 overflow-y-auto scrollbar-warhammer pr-2 space-y-1.5",children:[g.map(s=>{const r=i?.(s)??!1,u=o?.(s)??!1,b=d?.(s)??!1,j=t===s.index||t===s.label;return e.jsxs("div",{className:"relative",ref:j?m:void 0,"data-testid":`entity-item-${s.label}`,children:[e.jsx(T,{name:s.label,selected:j,onClick:()=>l(s),entity:s,reference:h?.(s),highlighted:b}),(r||u)&&e.jsxs("div",{className:"absolute top-1 right-1 flex gap-1",children:[r&&e.jsx(N,{variant:"secondary",className:"text-xs px-1 py-0",children:"Homebrew"}),u&&!r&&e.jsx(N,{variant:"outline",className:"text-xs px-1 py-0",children:"Modifié"})]})]},s.index??s.label)}),g.length===0&&e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{className:"text-sm text-muted-foreground",children:"Aucun résultat trouvé"})})]})]})}export{q as E,$ as P};

import{r as a,j as e,B as A,C as b,a as v,b as y,d as S,I as E,n as T,o as K,p as L,q as M,s as O}from"./index-B6PmHrA9.js";import{a as me,A as l}from"./builderStore-B1TiBw1E.js";import{u as xe}from"./Create-BXl-J9Uq.js";import{D as k}from"./dice-6-aMIQIm74.js";import"./constants--7Vy3u4O.js";import"./calculators-SnRFNRCc.js";import"./createCharacter-Bh61okBK.js";import"./PDFButton-cXuFwtr_.js";function be({step:i}){const{execute:n}=me(),{name:H,age:c,height:o,eyes:C,hair:N,options:t}=i.data,[I,P]=a.useState(H?String(H):""),[R,q]=a.useState(c?String(c):""),[w,F]=a.useState(o?String(o):""),J=c!==void 0?String(c):R,Q=o!==void 0?String(o):w,U=l.set("name"),W=l.set("age"),X=l.set("height"),Y=l.set("eyes"),Z=l.set("hair"),_=l.random("details"),$=l.random("age"),ee=l.random("height"),se=l.random("eyes"),ne=l.random("hair"),d=i.actions.find(s=>s.id===U),r=i.actions.find(s=>s.id===W),h=i.actions.find(s=>s.id===X),m=i.actions.find(s=>s.id===Y),x=i.actions.find(s=>s.id===Z),u=i.actions.find(s=>s.id===_),g=i.actions.find(s=>s.id===$),j=i.actions.find(s=>s.id===ee),f=i.actions.find(s=>s.id===se),p=i.actions.find(s=>s.id===ne),ae=a.useMemo(()=>{const s=[];return d&&s.push(d.id),r&&s.push(r.id),h&&s.push(h.id),m&&s.push(m.id),x&&s.push(x.id),u&&s.push(u.id),g&&s.push(g.id),j&&s.push(j.id),f&&s.push(f.id),p&&s.push(p.id),s},[d,r,h,m,x,u,g,j,f,p]);xe(ae);const D=a.useCallback(()=>{d&&I.trim()&&n(d.id,I.trim())},[d,I,n]),B=a.useCallback(()=>{r&&R.trim()&&n(r.id,Number(R))},[r,R,n]),z=a.useCallback(()=>{h&&w.trim()&&n(h.id,Number(w))},[h,w,n]),ie=a.useCallback(s=>{m&&n(m.id,s)},[m,n]),te=a.useCallback(s=>{x&&n(x.id,s)},[x,n]),le=a.useCallback(()=>{u&&n(u.id)},[u,n]),ce=a.useCallback(()=>{g&&n(g.id)},[g,n]),oe=a.useCallback(()=>{j&&n(j.id)},[j,n]),de=a.useCallback(()=>{f&&n(f.id)},[f,n]),re=a.useCallback(()=>{p&&n(p.id)},[p,n]),G=a.useMemo(()=>t?.eyeColors?[...new Set(t.eyeColors)]:[],[t]),V=a.useMemo(()=>t?.hairColors?[...new Set(t.hairColors)]:[],[t]),he=!!(c||o||C||N);return e.jsxs("div",{className:"flex flex-col gap-6 h-full max-w-2xl mx-auto",children:[e.jsx("div",{className:"flex justify-end flex-shrink-0",children:u&&e.jsxs(A,{"data-testid":"details-random-all",variant:"outline",onClick:le,children:[e.jsx(k,{className:"h-4 w-4 mr-2"}),he?"Relancer tout":"Générer tout"]})}),e.jsxs(b,{children:[e.jsx(v,{children:e.jsx(y,{children:"Nom du personnage *"})}),e.jsxs(S,{children:[e.jsx(E,{"data-testid":"details-name-input",value:I,onChange:s=>P(s.target.value),placeholder:"Entrez le nom...",onKeyDown:s=>s.key==="Enter"&&D(),onBlur:D,disabled:!d}),H&&e.jsxs("p",{className:"text-sm text-green-600 mt-2",children:["Nom: ",H]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs(b,{children:[e.jsxs(v,{className:"pb-2",children:[e.jsx(y,{className:"text-base",children:"Age"}),t?.ageRange&&e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Plage: ",t.ageRange]})]}),e.jsxs(S,{children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx(E,{type:"number",value:J,onChange:s=>q(s.target.value),placeholder:"Age...",onKeyDown:s=>s.key==="Enter"&&B(),onBlur:B,disabled:!r,min:1}),g&&e.jsx(A,{variant:"outline",size:"icon",onClick:ce,title:c?"Relancer":"Générer",children:e.jsx(k,{className:"h-4 w-4"})})]}),c&&e.jsxs("p",{className:"text-sm text-green-600 mt-2",children:[c," ans"]})]})]}),e.jsxs(b,{children:[e.jsxs(v,{className:"pb-2",children:[e.jsx(y,{className:"text-base",children:"Taille (cm)"}),t?.heightRange&&e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Plage: ",t.heightRange]})]}),e.jsxs(S,{children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx(E,{type:"number",value:Q,onChange:s=>F(s.target.value),placeholder:"Taille en cm...",onKeyDown:s=>s.key==="Enter"&&z(),onBlur:z,disabled:!h,min:1}),j&&e.jsx(A,{variant:"outline",size:"icon",onClick:oe,title:o?"Relancer":"Générer",children:e.jsx(k,{className:"h-4 w-4"})})]}),o&&e.jsxs("p",{className:"text-sm text-green-600 mt-2",children:[o," cm"]})]})]}),e.jsxs(b,{children:[e.jsx(v,{className:"pb-2",children:e.jsx(y,{className:"text-base",children:"Couleur des yeux"})}),e.jsxs(S,{children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(T,{value:C||"",onValueChange:ie,disabled:!m||G.length===0,children:[e.jsx(K,{className:"flex-1",children:e.jsx(L,{placeholder:"Choisir..."})}),e.jsx(M,{children:G.map(s=>e.jsx(O,{value:s,children:s},s))})]}),f&&e.jsx(A,{variant:"outline",size:"icon",onClick:de,title:C?"Relancer":"Générer",children:e.jsx(k,{className:"h-4 w-4"})})]}),C&&e.jsx("p",{className:"text-sm text-green-600 mt-2",children:C})]})]}),e.jsxs(b,{children:[e.jsx(v,{className:"pb-2",children:e.jsx(y,{className:"text-base",children:"Couleur des cheveux"})}),e.jsxs(S,{children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(T,{value:N||"",onValueChange:te,disabled:!x||V.length===0,children:[e.jsx(K,{className:"flex-1",children:e.jsx(L,{placeholder:"Choisir..."})}),e.jsx(M,{children:V.map(s=>e.jsx(O,{value:s,children:s},s))})]}),p&&e.jsx(A,{variant:"outline",size:"icon",onClick:re,title:N?"Relancer":"Générer",children:e.jsx(k,{className:"h-4 w-4"})})]}),N&&e.jsx("p",{className:"text-sm text-green-600 mt-2",children:N})]})]})]})]})}export{be as default};

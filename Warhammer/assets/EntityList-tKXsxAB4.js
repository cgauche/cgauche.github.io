import{h as w,j as e,I as k,n as I,o as L,i as j,p as S,q as V,s as N,a2 as _,aw as E,r as v,g as C}from"./index-DPNhxiUx.js";import{t as R}from"./testId-C2BDkHTB.js";const H=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],M=w("search",H);function T({placeholder:a,value:l,onChange:t,testId:c="entity-search"}){return e.jsxs("div",{className:"relative",children:[e.jsx(M,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),e.jsx(k,{placeholder:a,value:l,onChange:o=>t(o.target.value),className:"pl-10","data-testid":c})]})}function q({config:a,value:l,onChange:t,options:c,highlighted:o,highlightedOptions:h,compact:x}){return e.jsxs("div",{className:"flex items-center gap-2",children:[x&&e.jsxs("span",{className:"text-sm text-muted-foreground",children:[a.label,":"]}),e.jsxs(I,{value:l,onValueChange:t,children:[e.jsx(L,{className:j(x&&"h-8 w-auto min-w-[100px]",o&&"border-primary bg-primary/5 ring-1 ring-primary/30"),children:e.jsx(S,{placeholder:`Tous les ${a.label.toLowerCase()}`})}),e.jsxs(V,{children:[e.jsx(N,{value:"__all__",children:"Tous"}),c.map(n=>{const i=h?.has(n.value);return e.jsxs(N,{value:n.value,className:j(i&&"bg-primary/10 text-primary font-medium"),children:[n.label,i&&" ✦"]},n.value)})]})]})]})}function B({name:a,reference:l,selected:t=!1,highlighted:c=!1,muted:o=!1,onClick:h,className:x,rightContent:n,entity:i,categoryColor:y,categoryLabel:m}){const f=i?._type,u=f?_[f]?.ui:void 0,g=i&&u?.getCategoryValue?u.getCategoryValue(i):void 0,r=E(f,g),s=y||r||{badge:"hsl(var(--primary))",bg:"hsl(var(--primary) / 0.1)",border:"hsl(var(--primary))"},b=m||g,p=R("option",a);return e.jsx("div",{"data-testid":p,onClick:h,className:j("bg-card border rounded-md cursor-pointer transition-all","hover:border-primary/50 hover:translate-x-0.5",t&&"border-l-[3px] translate-x-1 ring-1 ring-primary/30",!t&&!c&&!o&&"border-secondary",c&&!t&&!o&&"border-primary/40 bg-primary/5",o&&!t&&"opacity-50 border-secondary",x),style:t&&s?{borderLeftColor:s.border,borderColor:s.border,backgroundColor:s.bg}:void 0,children:e.jsxs("div",{className:"flex items-start gap-2 p-2.5",children:[e.jsxs("div",{className:"flex items-start gap-2 flex-1 min-w-0",children:[s&&e.jsx("div",{className:"w-2 h-2 rounded-full flex-shrink-0 mt-1.5",style:{backgroundColor:s.badge}}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"font-inter font-semibold text-sm text-foreground truncate",children:a}),l&&e.jsx("div",{className:"text-[0.7rem] text-muted-foreground",children:l})]})]}),n!==void 0?n:b?e.jsx("div",{className:"text-xs px-2 py-0.5 rounded flex-shrink-0 font-medium",style:{color:s.badge,backgroundColor:s.bg},children:b}):null]})})}function A({entities:a,selectedId:l,onSelect:t,searchPlaceholder:c="Rechercher...",getSearchText:o,getReference:h,isHomebrew:x,isModified:n,isHighlighted:i,muted:y=!1}){const[m,f]=v.useState(""),u=v.useRef(null);v.useEffect(()=>{l&&u.current?.scrollIntoView&&u.current.scrollIntoView({behavior:"smooth",block:"nearest"})},[l]);const g=v.useMemo(()=>{if(!m)return a;const r=m.toLowerCase();return a.filter(d=>(o?o(d):d.label).toLowerCase().includes(r))},[a,m,o]);return e.jsxs("div",{className:"flex flex-col h-full gap-3",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(T,{placeholder:c,value:m,onChange:f})}),e.jsxs("div",{className:"flex-1 overflow-y-auto scrollbar-warhammer pr-2 space-y-1.5",children:[g.map(r=>{const d=x?.(r)??!1,s=n?.(r)??!1,b=i?.(r)??!1,p=l===r.index||l===r.label;return e.jsxs("div",{className:"relative",ref:p?u:void 0,"data-testid":`entity-item-${r.label}`,children:[e.jsx(B,{name:r.label,selected:p,onClick:()=>t(r),entity:r,reference:h?.(r),highlighted:b,muted:y&&!p}),(d||s)&&e.jsxs("div",{className:"absolute top-1 right-1 flex gap-1",children:[d&&e.jsx(C,{variant:"secondary",className:"text-xs px-1 py-0",children:"Homebrew"}),s&&!d&&e.jsx(C,{variant:"outline",className:"text-xs px-1 py-0",children:"Modifié"})]})]},r.index??r.label)}),g.length===0&&e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{className:"text-sm text-muted-foreground",children:"Aucun résultat trouvé"})})]})]})}export{A as E,q as P};

import{r as n,j as e,B as g}from"./index-BE7IJKJC.js";import{a as j,A as l}from"./builderStore-C-8nvYTR.js";import{u as B}from"./Create-A2heE6iP.js";import{B as k}from"./BudgetDisplay-Dr0tydf1.js";import{C,S as v,T as A}from"./TalentsBuyer--mvJmHc2.js";import{D as N}from"./dice-6-QrvFEPoj.js";import"./constants--7Vy3u4O.js";import"./calculators-SnRFNRCc.js";import"./createCharacter-Bh61okBK.js";import"./PDFButton-D0PW8ms3.js";import"./testId-C2BDkHTB.js";function M({step:o}){const{execute:t}=j(),c=o.data,d=l.random("experience"),a=o.actions.find(s=>s.id===d),m=n.useMemo(()=>{const s=o.actions.filter(r=>r.id.startsWith("buy-")).map(r=>r.id);return a&&s.push(a.id),s},[o.actions,a]);B(m);const{budget:i,buyableCharacteristics:u,buyableSkills:x,buyableTalents:p}=c,b=n.useCallback(s=>{t(l.buy("characteristic"),s,1)},[t]),h=n.useCallback(s=>{const[r]=s.split("|");t(l.buy("skill"),r,1)},[t]),y=n.useCallback(s=>{const[r]=s.split("|");t(l.buy("talent"),r,1)},[t]),f=n.useCallback(()=>{a&&t(a.id)},[a,t]);return e.jsxs("div",{className:"flex flex-col gap-4 h-full max-w-4xl mx-auto",children:[e.jsx(k,{label:"Points d'experience",used:i.spent+i.pending,total:i.total,remaining:i.remaining,action:a&&e.jsxs(g,{"data-testid":"experience-roll",variant:"outline",size:"sm",onClick:f,children:[e.jsx(N,{className:"h-4 w-4 mr-1"}),a.label]})}),i.remaining>0&&e.jsxs(e.Fragment,{children:[e.jsx(C,{characteristics:u,onBuy:b}),e.jsx(v,{skills:x,onBuy:h}),e.jsx(A,{talents:p,onBuy:y})]}),i.remaining===0&&e.jsx("div",{className:"rounded-lg border border-primary bg-card",children:e.jsx("div",{className:"p-4 text-center text-sm",children:"Tous vos points d'experience ont ete depenses."})}),i.remaining>0&&e.jsx("div",{className:"rounded-lg border border-amber-500/50 bg-card",children:e.jsxs("div",{className:"p-4 text-center text-sm text-amber-600 dark:text-amber-400",children:["Vous avez encore ",i.remaining," XP a depenser."]})})]})}export{M as default};

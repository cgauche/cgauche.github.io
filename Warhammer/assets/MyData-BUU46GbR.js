import{h as F,f as s,r as u,j as e,I as w,B as n,X as M,C as R,a as T,b as A,d as I,P as J,T as P,D as H,t as K,v as V,w as _,a1 as q,m as G}from"./index-BE7IJKJC.js";import{T as X,a as $,b as S,c as z}from"./tabs-BFQAKUJE.js";import{U as Q}from"./upload-C4eiB4wF.js";import{D as W}from"./download-CXJOmQdJ.js";import{C as Y}from"./checkbox-CRYFqpWS.js";const Z=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],ee=F("copy",Z);function ae(){const o=s(a=>a.datasets),r=s(a=>a.activeDatasetId),h=s(a=>a.createDataset),l=s(a=>a.deleteDataset),j=s(a=>a.duplicateDataset),t=s(a=>a.renameDataset),L=s(a=>a.exportDataset),B=s(a=>a.importDataset),N=s(a=>a.setActiveDataset),[p,D]=u.useState(""),[g,d]=u.useState(null),[f,v]=u.useState(""),C=u.useRef(null),b=()=>{p.trim()&&(h(p.trim()),D(""))},E=a=>{const i=L(a);if(!i)return;const m=new Blob([JSON.stringify(i,null,2)],{type:"application/json"}),x=URL.createObjectURL(m),c=document.createElement("a");c.href=x,c.download=`${i.metadata.name}.json`,c.click(),URL.revokeObjectURL(x)},O=a=>{const i=a.target.files?.[0];if(!i)return;const m=new FileReader;m.onload=x=>{try{const c=JSON.parse(x.target?.result),k=B(c);k.success||alert("Erreur import: "+k.errors.join(", "))}catch{alert("Fichier JSON invalide")}},m.readAsText(i),a.target.value=""},y=()=>{g&&f.trim()&&(t(g,f.trim()),d(null),v(""))},U=(a,i)=>{d(a),v(i)};return e.jsxs("div",{className:"space-y-6 mt-4",children:[e.jsx("input",{type:"file",ref:C,onChange:O,accept:".json",className:"hidden"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(w,{value:p,onChange:a=>D(a.target.value),placeholder:"Nom du nouveau dataset...",onKeyDown:a=>a.key==="Enter"&&b(),className:"flex-1"}),e.jsxs(n,{onClick:b,children:[e.jsx(M,{className:"h-4 w-4 mr-1"}),"Créer"]}),e.jsxs(n,{variant:"outline",onClick:()=>C.current?.click(),children:[e.jsx(Q,{className:"h-4 w-4 mr-1"}),"Importer"]})]}),e.jsxs("div",{className:"grid gap-4",children:[e.jsxs(R,{className:r===null?"ring-2 ring-primary":"",children:[e.jsx(T,{className:"pb-2",children:e.jsxs(A,{className:"text-lg flex items-center justify-between",children:["Officiel",e.jsx(n,{variant:"outline",size:"sm",onClick:()=>N(null),disabled:r===null,children:r===null?"Actif":"Activer"})]})}),e.jsx(I,{children:e.jsx("p",{className:"text-sm text-muted-foreground",children:"Données officielles (lecture seule)"})})]}),o.map(a=>e.jsxs(R,{className:r===a.metadata.id?"ring-2 ring-primary":"",children:[e.jsx(T,{className:"pb-2",children:e.jsxs(A,{className:"text-lg flex items-center justify-between",children:[a.metadata.name,e.jsxs("div",{className:"flex gap-1",children:[e.jsx(n,{variant:"outline",size:"sm",onClick:()=>N(a.metadata.id),disabled:r===a.metadata.id,children:r===a.metadata.id?"Actif":"Activer"}),e.jsx(n,{variant:"ghost",size:"icon",onClick:()=>j(a.metadata.id),title:"Dupliquer",children:e.jsx(ee,{className:"h-4 w-4"})}),e.jsx(n,{variant:"ghost",size:"icon",onClick:()=>U(a.metadata.id,a.metadata.name),title:"Renommer",children:e.jsx(J,{className:"h-4 w-4"})}),e.jsx(n,{variant:"ghost",size:"icon",onClick:()=>E(a.metadata.id),title:"Exporter",children:e.jsx(W,{className:"h-4 w-4"})}),e.jsx(n,{variant:"ghost",size:"icon",onClick:()=>l(a.metadata.id),title:"Supprimer",children:e.jsx(P,{className:"h-4 w-4"})})]})]})}),e.jsx(I,{children:e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Modifié le ",new Date(a.metadata.updatedAt).toLocaleDateString()]})})]},a.metadata.id))]}),e.jsx(H,{open:g!==null,onOpenChange:a=>!a&&d(null),children:e.jsxs(K,{children:[e.jsx(V,{children:e.jsx(_,{children:"Renommer le dataset"})}),e.jsx(w,{value:f,onChange:a=>v(a.target.value),placeholder:"Nouveau nom...",onKeyDown:a=>a.key==="Enter"&&y()}),e.jsxs(q,{children:[e.jsx(n,{variant:"outline",onClick:()=>d(null),children:"Annuler"}),e.jsx(n,{onClick:y,children:"Renommer"})]})]})})]})}function te(){const o=s(t=>t.book),r=s(t=>t.getActiveDataset),h=s(t=>t.toggleBook),l=r(),j=l?.activeBooks??o.map(t=>t.abr);return l?e.jsxs("div",{className:"mt-4 space-y-4",children:[e.jsxs("p",{className:"text-sm text-muted-foreground",children:['Cochez les livres à inclure dans le dataset "',l.metadata.name,'".']}),e.jsx("div",{className:"grid gap-2",children:o.map(t=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Y,{id:t.abr,checked:j.includes(t.abr),onCheckedChange:()=>h(t.abr)}),e.jsxs(G,{htmlFor:t.abr,className:"cursor-pointer",children:[t.label," (",t.abr,")"]})]},t.abr))})]}):e.jsx("div",{className:"mt-4 text-muted-foreground",children:"Sélectionnez un dataset personnalisé pour gérer les livres actifs."})}function ce(){return e.jsxs("div",{className:"container mx-auto px-8 py-6",children:[e.jsx("h1",{className:"text-2xl font-bold text-primary mb-6",children:"Mes données"}),e.jsxs(X,{defaultValue:"datasets",children:[e.jsxs($,{children:[e.jsx(S,{value:"datasets",children:"Datasets"}),e.jsx(S,{value:"books",children:"Livres"})]}),e.jsx(z,{value:"datasets",children:e.jsx(ae,{})}),e.jsx(z,{value:"books",children:e.jsx(te,{})})]})]})}export{ce as default};

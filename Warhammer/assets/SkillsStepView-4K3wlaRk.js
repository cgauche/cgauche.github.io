import{f as D,j as e,x as w,y as A,z as C,g as p,ab as k,B as f}from"./index-BE7IJKJC.js";import{a as j,A as x}from"./builderStore-C-8nvYTR.js";import{t as g}from"./testId-C2BDkHTB.js";import{B as v}from"./BudgetDisplay-Dr0tydf1.js";import{A as I}from"./AdjusterControls-C0A0AnSO.js";import{t as h}from"./constants--7Vy3u4O.js";import{D as N}from"./dice-6-QrvFEPoj.js";import"./calculators-SnRFNRCc.js";import"./createCharacter-Bh61okBK.js";import"./PDFButton-D0PW8ms3.js";function b({skill:i}){const t=D(s=>s.getSkillByLabel)(i.id),l=h(i);return t?t.desc&&t.desc.trim().length>0?e.jsxs(w,{children:[e.jsx(A,{asChild:!0,children:e.jsx("span",{className:"font-medium cursor-help underline decoration-dotted decoration-muted-foreground/50 underline-offset-2",children:l})}),e.jsx(C,{side:"top",className:"max-w-sm",children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-semibold",children:t.label}),e.jsx(p,{variant:"outline",className:"text-xs",children:t.type}),e.jsx(p,{variant:"secondary",className:"text-xs",children:t.characteristic})]}),e.jsx(k,{html:t.desc??"",className:"text-sm text-muted-foreground"})]})})]}):e.jsx("span",{className:"font-medium",children:l}):e.jsx("span",{className:"font-medium",children:l})}function T({skills:i,budget:n,step:t}){const{execute:l}=j(),o=t.actions.find(s=>s.role==="roll");return e.jsxs("div",{className:"flex flex-col gap-4 h-full",children:[e.jsx(v,{label:"Points de carriere",used:n.used,total:n.total,remaining:n.remaining,action:o&&e.jsxs(f,{"data-testid":"skills-career-roll",variant:"outline",size:"sm",onClick:()=>l(x.random("career-pool")),children:[e.jsx(N,{className:"h-4 w-4 mr-1"}),n.used>0?"Relancer":"Générer"]})}),e.jsx("div",{className:"flex-1 overflow-auto",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-2",children:i.map(s=>{const d=String(s._index),m=h(s),u=g("skill-career",m);return e.jsx("div",{className:"rounded-lg border bg-card","data-testid":u,children:e.jsxs("div",{className:"p-3 flex justify-between items-center",children:[e.jsx(b,{skill:s}),e.jsx(I,{value:s.career??0,valuePrefix:"+",onIncrement:()=>l(x.adjust("career","increment"),d),onDecrement:()=>l(x.adjust("career","decrement"),d),canIncrement:s.canIncrement??!1,canDecrement:s.canDecrement??!1,testId:u})]})},s._index)})})})]})}function U({step:i}){const{execute:n}=j(),t=i.data,{speciesSkills:l,careerSkills:o,speciesBudget:s,careerBudget:d,allowedBonusValues:m}=t,u=i.subphase??"species-bonuses",B=(a,r)=>{n("set-bonus",a,r)},S=i.actions.find(a=>a.role==="roll");return u==="career-pool"?e.jsx(T,{skills:o,budget:d,step:i}):e.jsxs("div",{className:"flex flex-col gap-4 h-full",children:[e.jsx(v,{label:"Bonus d'espece",used:s.used,total:s.total,remaining:s.remaining,action:S&&e.jsxs(f,{"data-testid":"skills-species-roll",variant:"outline",size:"sm",onClick:()=>n(x.random("species-bonuses")),children:[e.jsx(N,{className:"h-4 w-4 mr-1"}),s.used>0?"Relancer":"Générer"]})}),e.jsx("div",{className:"flex gap-2 text-sm",children:m.filter(a=>a>0).map(a=>{const r=s.patternUsage[a];return r?e.jsxs(p,{variant:r.used===r.available?"default":"secondary",children:["+",a,": ",r.used,"/",r.available]},a):null})}),e.jsx("div",{className:"flex-1 overflow-auto",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-2",children:l.map(a=>{const r=g("skill-species",h(a));return e.jsx("div",{className:"rounded-lg border bg-card","data-testid":r,children:e.jsxs("div",{className:"p-3 flex justify-between items-center",children:[e.jsx(b,{skill:a}),e.jsx("div",{className:"flex gap-1",children:m.map((c,y)=>e.jsx(f,{"data-testid":`${r}-bonus-${c}`,size:"sm",variant:a.specie===c?"default":"outline",className:"h-7 w-7 p-0",disabled:!(a.canAssign?.[y]??!0),onClick:()=>B(String(a._index),c),children:c},c))})]})},a._index)})})})]})}export{U as default};
